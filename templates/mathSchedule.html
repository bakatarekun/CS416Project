{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>

    <title>Second Website</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="myCss2.css">
    <script src="{% static 'myJs.js' %}"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>

    <script type="text/javascript">



        $(document).ready(function(){
            $.ajax({
                type: "GET",
                url: "/allTutorsNames/",
                dataType: "json",
                contentType: "application/json",
                success: function (data) {
                    console.log(data);
                    makerows(data);
                },

                error: function () {

                    alert("wasn't succesful");

                }
            });

        });


        function makerows(tutors) {

            var setoftutors = tutors;
            var counter = 9;
            var rowcounter = 0;
            var content = " <table><tbody name='tb'>"
            content += '<div><tr>'
            for (s = 8; s < 33; s++) {

                if (s > 8) {

                    if (s % 2 == 0) {
                        counter++;
                        if(counter==13){
                            counter=1;
                        }

                        content += '<th class="thformat">' + counter + ': 00' + '</th>'

                    } else {
                        content += '<th class="thformat">' + counter + ': 30' + '</th>'
                    }
                } else {
                    content += '<th class="thformat">' + '&nbsp' + '</th>'
                }

            }

            content += '</div></tr>';

            for (i = 0; i < setoftutors.length; i++) {
                content += '<tr name="rowtest">'
                for (s = 0; s < 25; s++) {

                    if (s == 0) {
                        content += '<td class="tdformat">' + setoftutors[i].fields.tutor[0] + '</td>'
                        rowcounter++
                    }
                    else
                    {
                        var name = setoftutors[i].fields.tutor[0];
                        if(setoftutors[i].fields.tutor[1] == 'EA')
                        {
                            content += '<td class="tdformat" name='+name + ' >' + '&nbsp' + '</td>'
                        }
                        else if (setoftutors[i].fields.tutor[1] == 'SA')
                        {
                            content += '<td class="tdformat"  name="sacell" >' + '&nbsp' + '</td>'
                        }
                        else
                        {
                            content += '<td class="tdformat"  name="workstudy" >' + '&nbsp' + '</td>'
                        }

                    }

                }
                content += '</tr>';
            }

            content += "<tbody>" + "</table>"
            $('#here_table').append(content);

            var hours;
            {#var typeofemployee;#}
            var listoftutors ='<ul>'
            listoftutors += '<div>'
            for (s = 0; s < setoftutors.length ; s++) {

                var name= setoftutors[s].fields.tutor[0];

                var typeofemployee =  setoftutors[s].fields.tutor[1];
                hours = setoftutors[s].fields.tutor[2];

                if(typeofemployee == 'EA')
                {
                    togglecells("td[name="+name+"]","eacellcolor", name);
                     console.log("ea name is "+ name);
                     console.log("type is " + typeofemployee);


                }
                else if (typeofemployee == 'SA')
                {
                    togglecells( "td[name=sacell]","sacellcolor",name);
                     console.log("sa name is "+ name);
                    console.log("type is " + typeofemployee);


                }
                else if (typeofemployee == 'Work Study')
                {
                    togglecells( "td[name=workstudy]","wscellcolor",name);
                     console.log("ws name is "+ name);
                console.log("type is " + typeofemployee);



                }

                listoftutors += '<li>' + name + ' <span id='+ name + '></span> Hours Left</li>'
            }

            listoftutors += '</div></ul>';
            $('#listoftutors').append(listoftutors);


            var hours2=0.0;
            $('tr').mouseout(function() {

                for (s = 0; s < setoftutors.length ; s++) {

                    var name1= setoftutors[s].fields.tutor[0];
                    var nameid = "#"+name1;
                    hours2 = setoftutors[s].fields.tutor[2];
                    var usedhours =  ($("td:contains("+name1+")").length-1)*.5;
                    hours2 = hours2 - usedhours;
                    $(nameid).text(hours2);


                }
                console.log(hours2 +" hours left");

            });




        }

    </script>


    <style type="text/css">
        table {
            border: 1px solid black;

        }
        th, td {
            border: 1px solid black;
            width:60px;
            text-align: center;
        }
        .eacellcolor {
            background: greenyellow;
        }
        .sacellcolor {
            background: deepskyblue;
        }
        .wscellcolor {
            background: yellow;
        }
        .tdformat{
            font-size: x-large;
            height: auto;
            width:auto;
        }
        .thformat{
            font-size: large;
            height: auto;

        }



    </style>
</head>

<!-- body of the site -->
<body id="top">

<br>
<br>
<div  style="text-align: center;">
    <div style="font-size: large" align='left' id="listoftutors"></div>
    <h1>Math Tutor Schedule</h1>
    <h3>Monday</h3>
</div>
<br>

<div align='center' id="here_table"></div>





</body>
</html>
